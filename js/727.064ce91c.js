"use strict";(self["webpackChunkadmin_motosusadas_uy"]=self["webpackChunkadmin_motosusadas_uy"]||[]).push([[727],{1862:function(e,a,l){l.r(a),l.d(a,{default:function(){return A}});l(4114);var t=l(641),s=l(33),u=l(3751),r=l(2807),n=l(276),i=l(3813),o=l(6756),d=l(5526),c=l(7973),m=l(3948);const v={class:"mt-7"},p={class:"mb-5"},b={class:""},f={class:"mb-5"};function h(e,a,l,h,y,g){const k=(0,t.g2)("Heading"),_=(0,t.g2)("search-users"),F=(0,t.g2)("Field"),w=(0,t.g2)("Form",!0),L=(0,t.g2)("SplitContent");return(0,t.uX)(),(0,t.Wv)(i.I,{fluid:"",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.bF)(k,null,{title:(0,t.k6)((()=>[(0,t.Lk)("h2",null,(0,s.v_)(e.$t("users-.details")),1),(0,t.Lk)("p",null,(0,s.v_)(e.$t("users-.details-sub-heading")),1)])),actions:(0,t.k6)((()=>[(0,t.eW)("Â  ")])),_:1}),(0,t.bo)((0,t.bF)(L,{"hide-auxiliar":!h.user},{auxiliar:(0,t.k6)((()=>[(0,t.bF)(_)])),default:(0,t.k6)((()=>[(0,t.bF)(w,{onSubmit:h.submitForm},{default:(0,t.k6)((({meta:l,errors:i})=>[(0,t.bF)(o.L,{justify:"center"},{default:(0,t.k6)((()=>[(0,t.bF)(d.B,{cols:"12",md:h.user?"8":""},{default:(0,t.k6)((()=>[(0,t.bF)(o.L,null,{default:(0,t.k6)((()=>[(0,t.bF)(d.B,{cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.Lk)("h4",v,(0,s.v_)(e.$t("users-.data")),1),(0,t.Lk)("p",p,(0,s.v_)(e.$t("users-.personal-information-text")),1)])),_:1}),(0,t.bF)(d.B,{cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:h.request.name,"onUpdate:modelValue":a[0]||(a[0]=e=>h.request.name=e),name:"name",rules:"required"},{default:(0,t.k6)((({field:a,errors:l,value:s})=>[(0,t.bF)(m.W,(0,t.v6)(a,{"model-value":s,variant:"outlined","error-messages":l,label:e.$t("name")}),null,16,["model-value","error-messages","label"])])),_:2},1032,["modelValue"])])),_:2},1024),(0,t.bF)(d.B,{cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:h.request.phoneNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>h.request.phoneNumber=e),name:"phoneNumber",rules:h.validatePhoneNumber},{default:(0,t.k6)((({field:a,errors:l,value:s})=>[(0,t.bF)(m.W,(0,t.v6)(a,{"model-value":s,variant:"outlined","error-messages":l,label:e.$t("phoneNumber")}),null,16,["model-value","error-messages","label"])])),_:2},1032,["modelValue","rules"])])),_:2},1024),(0,t.bF)(d.B,{cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.Lk)("h4",b,(0,s.v_)(e.$t("system-account")),1),(0,t.Lk)("p",f,(0,s.v_)(e.$t("users-.config-credentials")),1)])),_:1}),(0,t.bF)(d.B,{cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:h.request.email,"onUpdate:modelValue":a[2]||(a[2]=e=>h.request.email=e),name:"email",rules:h.validateEmail},{default:(0,t.k6)((({field:a,errors:l,value:s})=>[(0,t.bF)(m.W,(0,t.v6)(a,{"model-value":s,variant:"outlined","error-messages":l,label:e.$t("email")}),null,16,["model-value","error-messages","label"])])),_:2},1032,["modelValue","rules"])])),_:2},1024),h.user?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.Wv)(d.B,{key:0,cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:h.request.password,"onUpdate:modelValue":a[3]||(a[3]=e=>h.request.password=e),name:"password",rules:"required"},{default:(0,t.k6)((({field:a,errors:l,value:s})=>[(0,t.bF)(m.W,(0,t.v6)(a,{"model-value":s,variant:"outlined","error-messages":l,label:e.$t("password"),type:"password"}),null,16,["model-value","error-messages","label"])])),_:2},1032,["modelValue"])])),_:2},1024)),(0,t.bF)(d.B,{cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:h.request.accessLevel,"onUpdate:modelValue":a[4]||(a[4]=e=>h.request.accessLevel=e),name:"access-level",rules:"required"},{default:(0,t.k6)((({field:a,errors:l,value:s})=>[(0,t.bF)(c.d4,(0,t.v6)(a,{"model-value":s,variant:"outlined",label:e.$t("access-level"),"error-messages":l,items:h.accessLevels,"item-text":"title","item-value":"value"}),null,16,["model-value","label","error-messages","items"])])),_:2},1032,["modelValue"])])),_:2},1024),(0,t.bF)(d.B,{cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:h.request.agencyId,"onUpdate:modelValue":a[5]||(a[5]=e=>h.request.agencyId=e),name:"agency-id"},{default:(0,t.k6)((({field:a,errors:l,value:s})=>[((0,t.uX)(),(0,t.Wv)(c.d4,(0,t.v6)(a,{"model-value":s,items:h.agencies.length?h.agencies:[],"item-title":"name","item-value":"id",variant:"outlined",label:e.$t("agency"),"error-messages":l,clearable:"",key:"agency-select-"+h.agencies.length}),null,16,["model-value","items","label","error-messages"]))])),_:2},1032,["modelValue"])])),_:2},1024),(0,t.bF)(d.B,{cols:"12",class:"py-0"},{default:(0,t.k6)((()=>[h.user?((0,t.uX)(),(0,t.Wv)(n.a,{key:0,modelValue:h.request.active,"onUpdate:modelValue":a[6]||(a[6]=e=>h.request.active=e),label:e.$t("active"),"hide-details":"",class:"my-0"},null,8,["modelValue","label"])):(0,t.Q3)("",!0)])),_:1}),(0,t.bF)(d.B,{cols:"6"},{default:(0,t.k6)((()=>[(0,t.bF)(r.D,{elevation:"0",variant:"outlined",color:"red",block:"",onClick:a[7]||(a[7]=(0,u.D$)((a=>e.$router.push({name:"users"})),["prevent"]))},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(e.$t("discard")),1)])),_:1})])),_:1}),(0,t.bF)(d.B,{cols:"6"},{default:(0,t.k6)((()=>[(0,t.bF)(r.D,{color:"primary",type:"submit",disabled:!l.valid,elevation:"0",block:""},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(e.$t("submit")),1)])),_:2},1032,["disabled"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["md"])])),_:2},1024)])),_:1},8,["onSubmit"])])),_:1},8,["hide-auxiliar"]),[[u.aG,!h.isLoading]])])),_:1})}var y=l(953),g=l(6278),k=l(8309),_=l(8118),F=l(768),w=l(5152),L=l(5220),N=l(6808);const V=e=>{if(!e)return k.A.global.t("phone-required");const a=/^\+\d{10,15}$/;return!!a.test(e)||k.A.global.t("phone-invalid")};var $={components:{Heading:_.A,SplitContent:F.A,searchUsers:w.A},setup(){const e=(0,y.KR)(!0),a=(0,g.Pj)(),l=(0,y.KR)({name:"",email:"",phoneNumber:"",active:!0,accessLevel:1,agencyId:null,password:""}),s=(0,y.KR)(null),u=(0,L.lq)(),r=(0,L.rd)(),n=(0,y.KR)([{value:1,title:k.A.global.t("roles.agency")},{value:2,title:k.A.global.t("roles.admin")}]),i=(0,y.KR)(null);(0,t.wB)((()=>u.params.id),(async l=>{if(a.dispatch("SET_LOADING",!0),"string"===typeof l){const e=await N.A.getUserById(l);void 0!==e?(s.value={id:e.id,fullName:e.fullName,email:e.email,accessLevel:String(e.authLevel),active:e.active,phoneNumber:e.phoneNumber||"",...e.agencyId?{agencyId:e.agencyId}:{}},i.value={...s.value}):s.value=null}a.dispatch("SET_LOADING",!1),e.value=!1}),{immediate:!0}),(0,t.wB)(s,(e=>{e&&(l.value.name=e.fullName,l.value.email=e.email,l.value.active=e.active,l.value.accessLevel=Number(e.accessLevel)||1,l.value.phoneNumber=e.phoneNumber||"",l.value.agencyId=e.agencyId||null)}),{immediate:!0});const o=(0,t.EW)((()=>{const e=a.state.agencies.agencies||[];return e.map((e=>({id:e.id,name:e.name})))}));(0,t.sV)((async()=>{try{await a.dispatch("agencies/loadAgencies")}catch(e){}}));const d=async()=>{try{let t;if(s.value){const u={};l.value.name!==s.value.fullName&&(u.fullName=l.value.name),l.value.email!==s.value.email&&(u.email=l.value.email),l.value.phoneNumber!==s.value.phoneNumber&&(u.phoneNumber=l.value.phoneNumber),l.value.active!==s.value.active&&(u.active=l.value.active),Number(l.value.accessLevel)!==Number(s.value.accessLevel)&&(u.authLevel=Number(l.value.accessLevel)),l.value.agencyId!==s.value.agencyId&&(u.agencyId=l.value.agencyId);try{t=await a.dispatch("users/updateUser",{userId:s.value.id,data:u}),r.push({name:"users-details",params:{id:s.value.id}})}catch(e){return void await a.dispatch("notificator/errorResponse",e)}}else{const e={fullName:l.value.name,email:l.value.email,phoneNumber:l.value.phoneNumber,password:l.value.password||"DefaultPassword123!",authLevel:Number(l.value.accessLevel),agencyId:l.value.agencyId||null};t=await a.dispatch("users/createUser",e),r.push({name:"users-details",params:{id:t.id}})}t&&a.dispatch("notificator/success","succeeded_operation")}catch(e){await a.dispatch("notificator/errorResponse",e)}},c=e=>{if(!e)return k.A.global.t("email-required");const a=/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/;return!!a.test(e)||k.A.global.t("email-invalid")};return{request:l,submitForm:d,user:s,accessLevels:n,agencies:o,isLoading:e,validateEmail:c,validatePhoneNumber:V}}},I=l(6262);const q=(0,I.A)($,[["render",h],["__scopeId","data-v-e2dbb9b8"]]);var A=q},5152:function(e,a,l){l.d(a,{A:function(){return _}});var t=l(641),s=l(33),u=l(6756),r=l(5526),n=l(2164),i=l(7254),o=l(7294),d=l(7505),c=l(3948);const m={class:"text--primary"};function v(e,a,l,v,p,b){return(0,t.uX)(),(0,t.Wv)(u.L,null,{default:(0,t.k6)((()=>[(0,t.bF)(r.B,null,{default:(0,t.k6)((()=>[(0,t.bF)(u.L,null,{default:(0,t.k6)((()=>[(0,t.bF)(r.B,{class:"mt-2"},{default:(0,t.k6)((()=>[(0,t.bF)(c.W,{dense:"","hide-details":"",modelValue:v.search,"onUpdate:modelValue":a[0]||(a[0]=e=>v.search=e),variant:"outlined",label:e.$t("search")},null,8,["modelValue","label"])])),_:1})])),_:1}),(0,t.bF)(u.L,null,{default:(0,t.k6)((()=>[(0,t.bF)(r.B,{class:"py-0"},{default:(0,t.k6)((()=>[(0,t.bF)(n.x,{class:"v-list-search-result"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(v.filteredUsers,((a,l)=>((0,t.uX)(),(0,t.Wv)(i.g,{key:l,color:"primary",onClick:e=>v.selectedItem=l,selected:v.selectedItem===l},{default:(0,t.k6)((()=>[(0,t.bF)(o.U,null,{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(a.fullName?a.fullName:a.phoneNumber),1)])),_:2},1024),(0,t.bF)(d.w,null,{default:(0,t.k6)((()=>[(0,t.Lk)("span",m,(0,s.v_)(e.$t("roles."+v.getRoleKey(a.authLevel)))+":",1),(0,t.eW)(" "+(0,s.v_)(a.email?a.email:a.phoneNumber),1)])),_:2},1024)])),_:2},1032,["onClick","selected"])))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}l(4114);var p=l(5220),b=l(953),f=l(6278),h=l(9638),y={name:"SearchUsers",setup(){const e=(0,p.rd)(),a=(0,p.lq)(),l=(0,f.Pj)(),s=(0,b.KR)(null),u=(0,b.KR)(""),r=(0,b.KR)(null),n=(0,t.EW)((()=>l.state.users.users||[])),i=(0,t.EW)((()=>{if(!u.value)return n.value;const e=u.value.toLowerCase();return n.value.filter((a=>a.fullName&&a.fullName.toLowerCase().includes(e)||a.email&&a.email.toLowerCase().includes(e)||a.phoneNumber&&a.phoneNumber.toLowerCase().includes(e)))}));(0,t.wB)(u,(async()=>{s.value&&clearTimeout(s.value),s.value=window.setTimeout((function(){o()}),1e3)})),(0,t.wB)(r,(async a=>{let l="users-edit";"users-details"===e.currentRoute.value.name&&(l="users-details"),null!==r.value&&i.value[r.value]&&e.push({name:l,params:{id:i.value[r.value].id}})}));const o=async()=>{try{const e={search:u.value||null,limit:20,offset:0};await l.dispatch("users/loadUsers",e)}catch(e){l.dispatch("notificator/errorResponse",e)}};(0,t.sV)((async()=>{if(await o(),i.value){const e=i.value.findIndex((e=>e.id===a.params.id));-1!==e&&(r.value=e)}}));const d=e=>e===h.A.Admin?"admin":(h.A.Agency,"agency");return{users:n,timeout:s,search:u,selectedItem:r,loadItems:o,filteredUsers:i,getRoleKey:d}}},g=l(6262);const k=(0,g.A)(y,[["render",v],["__scopeId","data-v-0b675cca"]]);var _=k},276:function(e,a,l){l.d(a,{a:function(){return p}});var t=l(641),s=l(61),u=l(5035),r=l(6935),n=l(2067),i=l(4587),o=l(9094),d=l(1247),c=l(7861),m=l(4600);const v=(0,i.j)({...(0,u.V)(),...(0,o.cJ)((0,s.O)(),["inline"])},"VCheckbox"),p=(0,d.RW)()({name:"VCheckbox",inheritAttrs:!1,props:v(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,a){let{attrs:l,slots:i}=a;const d=(0,n.q)(e,"modelValue"),{isFocused:v,focus:p,blur:b}=(0,r.i)(e),f=(0,c.v6)(),h=(0,t.EW)((()=>e.id||`checkbox-${f}`));return(0,m.C)((()=>{const[a,r]=(0,o.ph)(l),n=u.Z.filterProps(e),c=s.M.filterProps(e);return(0,t.bF)(u.Z,(0,t.v6)({class:["v-checkbox",e.class]},a,n,{modelValue:d.value,"onUpdate:modelValue":e=>d.value=e,id:h.value,focused:v.value,style:e.style}),{...i,default:e=>{let{id:a,messagesId:l,isDisabled:u,isReadonly:n}=e;return(0,t.bF)(s.M,(0,t.v6)(c,{id:a.value,"aria-describedby":l.value,disabled:u.value,readonly:n.value},r,{modelValue:d.value,"onUpdate:modelValue":e=>d.value=e,onFocus:p,onBlur:b}),i)}})})),{}}})},6856:function(e,a,l){l.d(a,{_:function(){return c}});var t=l(641),s=l(3751),u=l(4587),r=l(1247),n=l(2419),i=l(1884),o=l(9886);const d=(0,u.j)({target:[Object,Array]},"v-dialog-transition"),c=(0,r.RW)()({name:"VDialogTransition",props:d(),setup(e,a){let{slots:l}=a;const u={onBeforeEnter(e){e.style.pointerEvents="none",e.style.visibility="hidden"},async onEnter(a,l){await new Promise((e=>requestAnimationFrame(e))),await new Promise((e=>requestAnimationFrame(e))),a.style.visibility="";const{x:t,y:s,sx:u,sy:r,speed:o}=v(e.target,a),d=(0,n.i)(a,[{transform:`translate(${t}px, ${s}px) scale(${u}, ${r})`,opacity:0},{}],{duration:225*o,easing:i.S8});m(a)?.forEach((e=>{(0,n.i)(e,[{opacity:0},{opacity:0,offset:.33},{}],{duration:450*o,easing:i.B2})})),d.finished.then((()=>l()))},onAfterEnter(e){e.style.removeProperty("pointer-events")},onBeforeLeave(e){e.style.pointerEvents="none"},async onLeave(a,l){await new Promise((e=>requestAnimationFrame(e)));const{x:t,y:s,sx:u,sy:r,speed:o}=v(e.target,a),d=(0,n.i)(a,[{},{transform:`translate(${t}px, ${s}px) scale(${u}, ${r})`,opacity:0}],{duration:125*o,easing:i.z3});d.finished.then((()=>l())),m(a)?.forEach((e=>{(0,n.i)(e,[{},{opacity:0,offset:.2},{opacity:0}],{duration:250*o,easing:i.B2})}))},onAfterLeave(e){e.style.removeProperty("pointer-events")}};return()=>e.target?(0,t.bF)(s.eB,(0,t.v6)({name:"dialog-transition"},u,{css:!1}),l):(0,t.bF)(s.eB,{name:"dialog-transition"},l)}});function m(e){const a=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list")?.children;return a&&[...a]}function v(e,a){const l=(0,o.Li)(e),t=(0,n.P)(a),[s,u]=getComputedStyle(a).transformOrigin.split(" ").map((e=>parseFloat(e))),[r,i]=getComputedStyle(a).getPropertyValue("--v-overlay-anchor-origin").split(" ");let d=l.left+l.width/2;"left"===r||"left"===i?d-=l.width/2:"right"!==r&&"right"!==i||(d+=l.width/2);let c=l.top+l.height/2;"top"===r||"top"===i?c-=l.height/2:"bottom"!==r&&"bottom"!==i||(c+=l.height/2);const m=l.width/t.width,v=l.height/t.height,p=Math.max(1,m,v),b=m/p||0,f=v/p||0,h=t.width*t.height/(window.innerWidth*window.innerHeight),y=h>.12?Math.min(1.5,10*(h-.12)+1):1;return{x:d-(s+t.left),y:c-(u+t.top),sx:b,sy:f,speed:y}}}}]);
//# sourceMappingURL=727.064ce91c.js.map